# DEC-M5-002: Hash-Chain Storage Backend

TYPE: DECISION
STATUS: UNRESOLVED
SCOPE: LOCAL
MODULE: M5 — Audit & Receipts
AI_ACTION_ALLOWED: 0

## QUESTION

What storage backend for hash-chained receipts: in-memory, SQLite, or external DB?

## CONTEXT

- Bible M5: "Hash-chain all receipts"
- Current: No hash-chaining implemented
- Hash-chain = each receipt includes hash of previous receipt (tamper-evident log)
- Backend deployed on Render (ephemeral filesystem — restarts lose in-memory data)

## OPTIONS

| Option | Description | Persistence | Complexity |
|--------|-------------|-------------|------------|
| A | In-memory (Map/Array) | Lost on restart | Lowest |
| B | SQLite (local file) | Survives restart if persistent disk | Low |
| C | PostgreSQL/MongoDB (external) | Full persistence | Medium |
| D | Append-only file log | Survives restart if persistent disk | Low |

## DEPENDENCIES

- Requires: DEC-M5-001

## ALLOWED ACTIONS

NONE.

## FORBIDDEN ACTIONS

- Do not add database dependencies
- Do not create receipt storage code
