# DEC-M1-002: Anti-Replay Mechanism Scope

TYPE: DECISION
STATUS: RESOLVED
SCOPE: LOCAL
MODULE: M1 — Network & Authority
AI_ACTION_ALLOWED: 1

## RESOLUTION

**Option A: Both Socket.IO and BinaryWebSocket**

Anti-replay (sequence numbers + HMAC) MUST be enforced on ALL communication protocols. No protocol may bypass anti-replay protection.

RESOLVED BY: Technical requirement from DEC-M1-001 (server authority mandates full protection)

## RATIONALE

- Server authority (DEC-M1-001) means all game traffic goes through server
- Socket.IO is the primary game protocol — cannot be left unprotected
- BinaryWebSocket already has nonce tracking (SessionManager.js)
- Full coverage eliminates protocol-downgrade attacks

## IMPLEMENTATION NOTES

- Extend SessionManager.js nonce tracking to Socket.IO events
- Each Socket.IO game event must include sequence number
- Server rejects out-of-sequence or replayed events
- Log all replay attempts per RL-005 (no silent punishment)
