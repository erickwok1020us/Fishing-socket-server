# DEC-M1-002: Anti-Replay Mechanism Scope

TYPE: DECISION
STATUS: UNRESOLVED
SCOPE: LOCAL
MODULE: M1 — Network & Authority
AI_ACTION_ALLOWED: 0

## QUESTION

Should anti-replay (sequence + HMAC) be enforced on Socket.IO protocol, BinaryWebSocket only, or both?

## CONTEXT

- Bible M1: "Anti-replay (sequence + HMAC)"
- Current: SessionManager.js has nonce tracking, but only used for BinaryWebSocket
- Current: Socket.IO (primary game protocol) has NO anti-replay
- Single-player mode uses neither protocol currently

## OPTIONS

| Option | Description | Coverage |
|--------|-------------|----------|
| A | Both Socket.IO and BinaryWebSocket | Full coverage |
| B | BinaryWebSocket only (current) | Partial — Socket.IO unprotected |
| C | Socket.IO only (migrate away from BinaryWebSocket) | Simpler, one protocol |

## DEPENDENCIES

- Requires: DEC-M1-001 (determines if single-player needs this at all)

## ALLOWED ACTIONS

NONE.

## FORBIDDEN ACTIONS

- Do not modify SessionManager.js
- Do not add HMAC to Socket.IO events
