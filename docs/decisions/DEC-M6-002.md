# DEC-M6-002: Rules Hash Versioning

TYPE: DECISION
STATUS: RESOLVED
SCOPE: LOCAL
MODULE: M6 — Release & Immutability
AI_ACTION_ALLOWED: 1

## RESOLUTION

**Option A: Auto-increment — hash computed on server start, version increments if hash differs from last**

Server computes config hash on startup. If hash differs from previous version, version auto-increments. Fully automatic, no manual discipline required.

RESOLVED BY: Technical analysis — auto-increment eliminates human error in version management

## RATIONALE

- Automatic detection eliminates risk of forgetting to bump version
- Hash comparison is deterministic and reliable
- Version history can be stored in append-only log
- Operators cannot silently change config without version changing (RL-012)

## IMPLEMENTATION NOTES

- On server start: compute CONFIG_HASH (per DEC-M6-001)
- Load previous version from version file: /data/config-versions.jsonl
- If CONFIG_HASH differs from last entry: increment version, append new entry
- Version format: integer counter (1, 2, 3, ...)
- Each receipt includes: { rules_hash: CONFIG_HASH, rules_version: VERSION }
- Version file is append-only (tamper-evident)
