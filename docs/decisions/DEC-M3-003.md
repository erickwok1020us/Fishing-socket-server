# DEC-M3-003: HP Derivation Function

TYPE: DECISION
STATUS: RESOLVED
SCOPE: LOCAL
MODULE: M3 — Crypto Fairness (ZK HP)
AI_ACTION_ALLOWED: 1

## RESOLUTION

**Option A: HMAC-SHA256(seed, fishType + spawnIndex + roomId) mod hpRange**

HP is derived deterministically using HMAC-SHA256 with the spawn seed as key and fish parameters as message.

RESOLVED BY: Technical analysis — HMAC-SHA256 is standard, deterministic, and verifiable

## RATIONALE

- HMAC-SHA256 is a standard cryptographic PRF — well-audited, widely available
- Deterministic: same inputs always produce same HP (required for verification)
- Fish parameters (type + index + roomId) ensure unique HP per fish
- Compatible with seed commitment scheme (DEC-M3-002)
- Bible Distribution: HP range +/-20-35% of mean, center-weighted

## IMPLEMENTATION NOTES

- Input: HMAC-SHA256(key=seed, message=fishType||spawnIndex||roomId)
- Output: Take first 4 bytes as uint32
- HP = baseHP + (uint32 % hpRange) where hpRange = maxHP - minHP
- Center-weighting: use sum of 2 HMAC outputs (triangular distribution approximation)
- baseHP and hpRange per fish type from FISH_SPECIES config
- Must satisfy POL-DIST-001: +/-20-35% of mean, no exploitable outliers (RL-013)
